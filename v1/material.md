## Материалы
material.js

[Главная](README.md)  /  [Система управления производством](production.md)

### Получение материалов

Для получения списка материалов необходимо отправить **`GET`** запрос на **`/api/material/:g_id`**<br>

Пример ответа:<br>
```
[
    {
        "_id": "618e640bb05d2840612b4687",
        "g_id": "60a959e632a2dcd7f7ac8daf",
        "name": "Тестовый материал",
        "measure": "Метр квадратный",
        "description": "Нет описания"
    },
    {
        "_id": "618e65acb05d2840612b4689",
        "g_id": "60a959e632a2dcd7f7ac8daf",
        "name": "Тестовый материал",
        "measure": "сантиметры",
        "description": "нет описания"
    }
]
```

Параметры:<br>
**g_id*** - Идентификатор группы материалов<br>

<br>

### Получение материала

Для получения материала необходимо отправить **`GET`** запрос на **`/api/material_info/:id`**<br>

Пример ответа:<br>
```
[
    {
        "_id": "618e65acb05d2840612b4689",
        "g_id": "60a959e632a2dcd7f7ac8daf",
        "name": "Тестовый материал",
        "measure": "сантиметры",
        "description": "нет описания",
        "value": {
            "тест": "тест"
        }
    }
]
```

Параметры:<br>
**id*** - Идентификатор материала<br>

<br>

### Создание нового материала

Для создания нового материала необходимо отправить **`POST`** запрос на **`/api/material`**<br>

Пример отправки параметров:<br>
```
{
    "mg_id":
    [
    	"5d754a01b128da140c95eed8",
    	"5d755e0dd4da3d467c5c2033"
    ],
    "name": "Карбон"
    "measure": "м.кв"
}
```

Параметры:<br>
**mg_id*** - Цепочка идентификаторов групп нового материала<br>
**name*** - Имя материала<br>
**measure** - Мера измерения (выбирается из статического списка)<br>

Ответ:<br> коды состояний 204 или 404.

<br>

### Редактирование материала

Для редактирования материала необходимо отправить **`PUT`** запрос на **`/api/material`**<br>

Пример отправки параметров:<br>
```
{
    "_id":"5cf6ebe496a76a6c5aadb18f",
    "mg_id":
    [
    	"5d754a01b128da140c95eed8",
    	"5d755e0dd4da3d467c5c2033"
    ],
    "name": "Карбон тестовый",
    "measure": "л."
}
```

Параметры:<br>
**id*** - Идентификатор материала<br>
**mg_id*** - Цепочка идентификаторов групп материала<br>
**name*** - Имя материала<br>
**measure** - Мера измерения (выбирается из статического списка)<br>

Ответ:<br> коды состояний 204 или 404.

<br>

### Удаление материала

Для удаления материала необходимо отправить **`DELETE`** запрос на **`/api/material/:id`**<br>

Параметры:<br>
**id*** - Идентификатор материала<br>

Ответ:<br> коды состояний 204 или 404.

<br>

### Получение цветов материала

Для получения цветов материала необходимо отправить **`GET`** запрос на **`/color/:id`**<br>

Пример ответа:<br>
```
[
    {
        "c_id": "5cf8126062eb21ed4ac7968e",
        "name": "Бордовый",
        "quantity": 36,
        "rate": 100
    },
    {
        "c_id": "5cf8128262eb21ed4ac7968f",
        "name": "Синий",
        "quantity": 32,
        "rate": 100
    },
    {
        "c_id": "5cf812ca62eb21ed4ac79690",
        "name": "Коричневый",
        "quantity": 60,
        "rate": 100
    }
]
```

Параметры:<br>
**id*** - Идентификатор материала<br>

<br>

### Создание нового цвета материала

Для создания нового цвета необходимо отправить **`POST`** запрос на **`/api/color`**<br>

Пример отправки параметров:<br>
```
{
    "_id": "5cf81334eb03a9ed4acd8e2d",
    "name": "Синий",
    "quantity": 26
}
```

Параметры:<br>
**_id*** - Идентификатор материала<br>
**name*** - Имя цвета<br>
**quantity*** - Количество<br>
**rate*** - Наценка<br>

Ответ:<br> коды состояний 204 или 404.

<br>

### Редактирование цвета материала

Для редактирования цвета материала необходимо отправить **`PUT`** запрос на **`/api/color`**<br>

Пример отправки параметров:<br>
```
{
    "_id":"5cf81334eb03a9ed4acd8e2d",
    "c_id":"60a6dc42040dca384cc75cfd",
    "name": "Жёлтый6",
    "quantity": 26,
    "rate": 21
}
```

Параметры:<br>
**_id*** - Идентификатор материала<br>
**c_id*** - Идентификатор цвета<br>
**name*** - Имя цвета<br>
**quantity*** - Количество<br>
**rate*** - Наценка<br>

Ответ:<br> коды состояний 204 или 404.

<br>

### Удаление цвета

Для удаления цвета необходимо отправить **`DELETE`** запрос на **`/api/color/:_id/:c_id`**<br>

Параметры:<br>
**_id*** - Идентификатор материала<br>
**c_id*** - Идентификатор цвета<br>

Ответ:<br> коды состояний 204 или 404.

<br>

### Получение BOM

Для получения материала необходимо отправить **`GET`** запрос на **`/bom_new/:m_id/:filter_date/:grade`**<br>
Описание: Для верхнего урованя (конечная продукция/родительский узел) grade передавать не нужно, на нижние уровни (разветвления) передаём grade верхнего уровня (родительский grade)<br>

Параметры:<br>
**m_id*** - Идентификатор материала<br>
**filter_date*** - Текущая дата<br>
**grade*** - Комплектация (массив, находиться в "value.grade"). <br>
   Пример: <br>
   [<br>
     {"r_id": "642b0995507acba2fa401a48", "a_id": "64058bb0d6ef95a980f29b34", "take": 8, "return": 0},<br>
     {"r_id": "64184083c17b5d7e359ee4d3", "a_id": "642bf16168d67b78a2afc45b", "take": 3, "return": 0}<br>
   ]
<br>  

Пример ответа:<br>
```
[
    {
        "_id": "640237adff8d6b0e26819dfc",
        "operation": "Сборка бампера",
        "compliance_rate": "2400000",
        "res_m": [
            {
                "name": "Resource 13",
                "status": true,
                "r_id": "64023a4b935d7a8d7e4a9ff0",
                "type": "material",
                "conditions": [
                    {
                        "a_id": "6402fcaeff8d6b0e2681a626",
                        "r_index": 12,
                        "take": 0,
                        "return": 1
                    }
                ],
                "change": false,
                "arsenal": {
                    "a_id": "6402fcaeff8d6b0e2681a626",
                    "r_index": 12,
                    "take": 0,
                    "return": 1,
                    "name": "Бампер модель Б1",
                    "amount": 0
                }
            },
            {
                "name": "Resource 7",
                "status": true,
                "r_id": "640238c6723dd04214260b33",
                "type": "material",
                "conditions": [
                    {
                        "a_id": "640236b6ff8d6b0e26819df6",
                        "r_index": 6,
                        "take": 8,
                        "return": 0
                    }
                ],
                "change": false,
                "arsenal": {
                    "a_id": "640236b6ff8d6b0e26819df6",
                    "r_index": 6,
                    "take": 8,
                    "return": 0,
                    "name": "Болт М16х 1,5-6gх35",
                    "amount": 1000
                }
            },
            {
                "name": "Resource 11",
                "status": true,
                "r_id": "6402394ccbadd761aac04244",
                "type": "material",
                "conditions": [
                    {
                        "a_id": "64023745ff8d6b0e26819dfa",
                        "r_index": 10,
                        "take": 8,
                        "return": 0
                    }
                ],
                "change": false,
                "arsenal": {
                    "a_id": "64023745ff8d6b0e26819dfa",
                    "r_index": 10,
                    "take": 8,
                    "return": 0,
                    "name": "Шайба пружинная 16",
                    "amount": 900
                }
            }
        ],
        "res_w": [
            {
                "name": "Resource 1",
                "status": true,
                "r_id": "64023800d4027812d445e2ca",
                "type": "worker",
                "conditions": [
                    {
                        "a_id": "640073c253d5a7d95a8f86d4",
                        "r_index": 0,
                        "take": 1,
                        "return": 1
                    },
                    {
                        "a_id": "64058fdfd6ef95a980f29b56",
                        "r_index": 0,
                        "take": 1,
                        "return": 1
                    },
                    {
                        "a_id": "640eda8c34903b7cc212cca3",
                        "r_index": 0,
                        "take": 1,
                        "return": 1
                    }
                ],
                "change": false,
                "arsenal": {
                    "a_id": "640073c253d5a7d95a8f86d4",
                    "r_index": 0,
                    "take": 1,
                    "return": 1,
                    "name": "Попов Михаил",
                    "amount": 1
                }
            }
        ],
        "res_e": [],
        "res_d": [],
        "position": {
            "r_id": "642b0995507acba2fa401a48",
            "a_id": "64058bb0d6ef95a980f29b34",
            "take": 8,
            "return": 0
        }
    }
]
```

Параметры:<br>
**id*** - Идентификатор материала<br>