## Планирование
planning.js

[Главная](README.md)  /  [Manufacturing Execution System](mes.md)

### Получение списка планирований

Для получения списка планирований необходимо отправить **`GET`** запрос на **`/api/planning/:g_id`**<br>

Пример ответа:<br>
```
[
    {
        "_id": "608abb6b60699007fac77f67",
        "name": "Новое планирование",
        "s_id": "5ea9e7ba0dece21b35dba64a",
        "stream_name": "Тест паралельных операций"
    },
    {
        "_id": "609b7d01fe1b3840e89a9ae0",
        "name": "Новое планирование 2",
        "s_id": "5ea9e7ba0dece21b35dba64a",
        "stream_name": "Тест паралельных операций"
    }
]
```

Параметры:<br>
**g_id*** - Идентификатор группы<br>

<br>

### Получение планирования

Для получения планирования необходимо отправить **`GET`** запрос на **`/api/planning_info/:_id`**<br>

Пример ответа:<br>
```
[
    {
        "_id": "608abb6b60699007fac77f67",
        "name": "Новое планирование",
        "s_id": "5ea9e7ba0dece21b35dba64a",
        "condition": [
            {
                "type": "material",
                "m_id": "5cf7abef4829431ec863a9d1",
                "condition": "gte",
                "value": 5
            },
            {
                "type": "material",
                "m_id": "5cf8128262eb21ed4ac7968f",
                "condition": "gte",
                "value": 4
            }
        ],
        "history": [
            {
                "date": "2021-05-18T16:00:00.000Z"
            }
        ]
    }
]
```

Параметры:<br>
**_id*** - Идентификатор планирования<br>

<br>

###  Получение заказов для планирования

Для получения заказов для планирования необходимо отправить **`GET`** запрос на **`/api/order_planning`**<br>

Пример ответа:<br>
```
[
    {
        "_id": "5e21b0bc7ef0d64448df7896",
        "p_id": "608abb6b60699007fac77f67",
        "name": "Audi 100 1990-1994"
    },
    {
        "_id": "5e21b0dd7ef0d64448df7897",
        "p_id": "608abb6b60699007fac77f67",
        "name": "BMW 5 1995-2000"
    },
    {
        "_id": "5e21b0ff7ef0d64448df7898",
        "name": "Chery Amulet 2003-2012"
    }
]
```

<br>

###  Получение потоков для планирования

Для получения потоков для планирования необходимо отправить **`GET`** запрос на **`/api/stream_planning`**<br>

Пример ответа:<br>
```
[
    {
        "_id": "5ea9e7ba0dece21b35dba64a",
        "name": "Тест паралельных операций"
    },
    {
        "_id": "5f72ee4709988855fb90d8f5",
        "name": "Тест комплект с двойной строчкой"
    },
    {
        "_id": "5f73278a762cd264ad20bb58",
        "name": "Тест комплект без двойной отстрочки"
    }
]
```

<br>

### Создание планирования

Для создания планирования необходимо отправить **`POST`** запрос на **`/api/planning`**<br>

Пример отправки параметров:<br>
```
{
   "name":"Новое планирование",
   "s_id":"5ea9e7ba0dece21b35dba64a",
   "condition":[
      {
         "type":"material",
         "m_id":"5cf7abef4829431ec863a9d1",
         "condition":"gte",
         "value":5
      },
      {
         "type":"material",
         "m_id":"5cf8128262eb21ed4ac7968f",
         "condition":"gt",
         "value":4
      }
   ]
}
```

Параметры:<br>
**name*** - Название планирования<br>
**s_id*** - Идентификатор потока по которому будут выполнятся выбранные заказы<br>
**type** - Тип данных для условия (по умолчанию всегда ставим "material")<br>
**m_id** - Идентификатор материала<br>
**condition*** - Условие выполнения операции "=" - "eq", "⩽" - "lte", "⩾" - "gte", "<" - "lt", ">" - "gt"<br>
**value*** - Значение с которым будем сравнивать<br>

Ответ:<br> коды состояний 204 или 404.

<br>

### Редактирование планирования

Для редактирования планирования необходимо отправить **`PUT`** запрос на **`/api/planning`**<br>

Пример отправки параметров:<br>
```
{
    "_id": "6108eed404e3e7482cfb9815",
    "name":"Новое планирование",
    "s_id":"5ea9e7ba0dece21b35dba64a",
    "condition":[
        {
            "type":"material",
            "m_id":"5cf7abef4829431ec863a9d1",
            "condition":"lte",
            "value":5,
            "material_name": "Нитки обычные (Жёлтый)"
        },
        {
            "type":"material",
            "m_id":"5cf8128262eb21ed4ac7968f",
            "condition":"gt",
            "value":4,
            "material_name": "Нитки для двойной отстрочки (Черный 901)"
        }
    ]
}
```

Параметры:<br>
**name*** - Название планирования<br>
**s_id*** - Идентификатор потока по которому будут выполнятся выбранные заказы<br>
**type** - Тип данных для условия (по умолчанию всегда ставим "material")<br>
**m_id** - Идентификатор материала<br>
**condition*** - Условие выполнения операции "=" - "eq", "⩽" - "lte", "⩾" - "gte", "<" - "lt", ">" - "gt"<br>
**value*** - Значение с которым будем сравнивать<br>

Ответ:<br> коды состояний 204 или 404.

<br>

### Добавление или удалиние планирования в заказе

Для редактирования планирования необходимо отправить **`PUT`** запрос на **`/api/order_planning`**<br>

Пример отправки параметров:<br>
```
{
    "_id": "5e21b0dd7ef0d64448df7897",
    "p_id": "608abb6b60699007fac77f62"
}
```

Параметры:<br>
**_id*** - Идентификатор заказа<br>
**p_id*** - Идентификатор планирования<br>

Ответ:<br> коды состояний 204 или 404.

<br>

### Удаление операции

Для удаления планирования необходимо отправить **`DELETE`** запрос на **`/api/planning/:_id`**<br>

Параметры:<br>
**_id*** - Идентификатор планирования<br>

Ответ:<br> коды состояний 204 или 404.

<br>
